<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>诊辅系统-后台管理</title>
    <link rel="stylesheet" href="/js/bootstrap/bootstrap-v4.3.1.min.css">
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="stylesheet" type="text/css" href="/js/bootstrap/datepicker/bootstrap-datetimepicker.min.css">
</head>

<body>
<nav class="navbar navbar-light" style="background-color: #3498db;">
    <a class="navbar-brand" href="#">诊辅系统-后台管理</a>
    <div class="collapse navbar-collapse" id="navbarNav" style="float: right">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Features</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Pricing</a>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
        </li>
      </ul>
    </div>
    <div class="form-inline my-2 my-lg-0" id="userBox" style="margin-right: 2rem">
        <ul>
            <li class="dropdown  nav-item">
                <a class="nav-link" id="header-userDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="glyphicon glyphicon-user adminName">
                             <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>Loading...
                        </span>
                    <span class="caret"></span>
                </a>
                <div class="dropdown-menu" aria-labelledby="userDropdown">
                    <a class="dropdown-item" id="admin-loginOut" href="javascript:;">退出</a>
                </div>
            </li>
            <li><a class="nav-link">使用说明</a></li>
        </ul>
    </div>
</nav>
<div class="">
    <nav class="container" style="margin-top: 3rem;font-size: 21px;">
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <a class="nav-item nav-link  active" id="showData-tab" data-toggle="tab" href="#showData"
               role="tab" aria-controls="reservationsClass" aria-selected="true">数据展示</a>
            <a class="nav-item nav-link " id="userData-tab" data-toggle="tab" href="#userData"
               role="tab" aria-controls="userData" aria-selected="false">用户管理</a>
            <a class="nav-item nav-link " id="courseTypeBox-tab" data-toggle="tab"
               href="#courseTypeBox"
               role="tab" aria-controls="courseTypeBox" aria-selected="false">课程类别管理</a>
        </div>
    </nav>
    <div class="tab-content " id="nav-tabContent">
        <div class="tab-pane fade  p-2 show active" id="showData" role="tabpanel"
             aria-labelledby="showData-tab">
            <div class="row" id="top-show-box">
                <div class="col-md-6">
                    <div class=" border jumbotron show-box row " id="number-show-box">
                        <div class="col-md-7">
                            <div class="title">
                                <h3>过去7天课程类别占比情况</h3>
                            </div>
                            <hr class="my-4">
                            <div class="content" id="courses-show-box-container">
                            </div>
                        </div>
                        <div class="col-md-5" style="padding-top: 2rem;">
                            <div id="show-pie-chart"
                                 style="height: 330px;width: 100%;  text-align: center;"></div>
                        </div>
                    </div>

                </div>
                <div class="col-md-6">
                    <div class=" border jumbotron show-box row " id="future-box">
                        <div class="col-md-12">
                            <div class="title">
                                <h3>未来30天课程发布情况</h3>
                            </div>
                            <hr class="my-4">
                            <div class="content" >
                                <table class="table text-center table-set">
                                    <thead>
                                    <tr>
                                        <th >序号</th>
                                        <th >时间</th>
                                        <th >类别</th>
                                        <th >老师</th>
                                        <th >状态</th>
                                        <th >详细</th>
                                    </tr>
                                    </thead>
                                    <tbody id="show-issue-box-container"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="container border jumbotron show-box" id="show-data-box">
                <div class="title">
                    <h3>过去一个月课程发布情况</h3>
                </div>
                <hr class="my-4">
                <div class="row">
                    <div class="content col-md-6" id="show-data-content" style="width: 100%;height:400px;">
                    </div>
                    <div class="col-md-6">
                        <table class="table text-center table-set">
                            <thead>
                            <tr>
                                <th style="width: 100px">序号</th>
                                <th style="width: 160px">时间</th>
                                <th style="width: 100px">类别</th>
                                <th style="width: 90px">老师</th>
                                <th style="width: 100px">详细</th>
                            </tr>
                            </thead>
                            <tbody id="show-history-box-container"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="tab-pane fade  p-2 show container " id="userData" role="tabpanel"
             aria-labelledby="userData-tab">
                <div class="row">
                    <div class="col-md-12">
                        <div class=" border jumbotron show-box " style="height: 600px;" id="stu-msg-list">
                             <div class="title">
                                <h3>学生用户信息列表</h3>
                            </div>
                                <hr class="my-4">
                            <div>
                                <table class="table text-center table-set">
                                    <thead>
                                        <tr>
                                            <th>序号</th>
                                            <th>ID</th>
                                            <th>NBR</th>
                                            <th>姓名</th>
                                            <th>性别</th>
                                            <th>电话</th>
                                            <th>更新时间</th>
                                            <th>编辑</th>
                                        </tr>
                                    </thead>
                                    <tbody id="show-stu-list-container"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class=" border jumbotron show-box " style="height: 600px;" id="tea-msg-list">
                            <div class="title">
                                <h3>教师用户信息列表</h3>
                            </div>
                            <hr class="my-4">
                            <div>
                                <table class="table text-center table-set">
                                    <thead>
                                    <tr>
                                        <th>序号</th>
                                        <th>ID</th>
                                        <th>NBR</th>
                                        <th>姓名</th>
                                        <th>性别</th>
                                        <th>电话</th>
                                        <th>更新时间</th>
                                        <th>编辑</th>
                                    </tr>
                                    </thead>
                                    <tbody id="show-tea-list-container"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class=" border jumbotron show-box " id="input-user-msg">
                            <div class="title">
                                <h3>用户信息导入</h3>
                            </div>
                            <hr class="my-4">
                            <div class="row" id="input-select-box">
                                <div class="col-md-6">
                                    <a class="btn btn-primary" id="input-once">手动导入单个用户</a>
                                </div>
                                <div class="col-md-6">
                                    <a class="btn btn-primary" id="input-batch">批量导入多个用户</a>
                                </div>
                            </div>
                            <div id="back-select-box" style="display: none;height: 2rem;">
                                <p>
                                    <a id="back-select-btn" href="javascript:;" style="float: right;">返回导入选项 →</a>
                                </p>
                            </div>
                            <div id="upload-box" style="display: none">
                                <div class="row">
                                    <div class="col-md-4">
                                        <a href="/dtr/user-file/download">👉模板下载</a>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="sr-only" for="userFile">文件输入</label>
                                        <input type="file" id="userFile" name="userFile">
                                    </div>
                                    <div class="col-md-2">
                                        <button id="upload-btn" class="btn btn-primary">提交</button>
                                    </div>
                                </div>
                                <div class="progress" id="userFile-icons" style="display: none">
                                    <div class="progress-bar" role="progressbar" aria-valuenow="60"
                                         aria-valuemin="0" aria-valuemax="100" style="width: 40%;">
                                        <span class="sr-only"><span id="upload-down"></span> 完成</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="msg-input-box" style="padding-top: 1.2rem; display: none">
                                <div class="col-md-4 text-xl-center ">
                                    <h5><img src="/images/classTime.png" alt=""> 用户姓名</h5>
                                    <input class="form-control" id="userName" type="text"/>
                                </div>
                                <div class="col-md-4 text-xl-center ">
                                    <h5><img src="/images/classTime.png" alt=""> 用户类别</h5>
                                    <select class="form-control" id="userType">
                                        <option value="学生">学生</option>
                                        <option value="教师">教师</option>
                                        <option value="家长">家长</option>
                                    </select>
                                </div>
                                <div class="col-md-4 text-xl-center classTime">
                                    <h5><img src="/images/classTime.png" alt=""> 用户学号/工号</h5>
                                    <input class="form-control" id="userNbr" type="text"/>
                                </div>
                                <div class="col-md-4 text-xl-center classTime">
                                    <h5><img src="/images/classTime.png" alt=""> 用户性别</h5>
                                    <input class="form-control" id="userSex" type="text"/>
                                </div>
                                <div class="col-md-4 text-xl-center classTime">
                                    <h5><img src="/images/classTime.png" alt=""> 用户电话</h5>
                                    <input class="form-control" id="userPhone" type="text"/>
                                </div>
                                <button id="msg-input-btn" class="btn btn-primary">提交</button>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
        <div class="tab-pane fade  p-2 show " id="courseTypeBox" role="tabpanel"
             aria-labelledby="courseTypeBox-tab">
        </div>
</div>

</div>
<div class="modal fade" id="courseMsgModel" tabindex="-1" data-backdrop="static" role="dialog"
     aria-labelledby="courseMsgModelLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="courseMsgModelLabel">课程详细信息</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body table-set" style="padding-bottom: 0;">
                <table class="table text-center table-striped  shadow">
                    <tbody id="course-msg-container">
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="checkMsgModel" tabindex="-1" data-backdrop="static" role="dialog"
     aria-labelledby="checkMsgModelLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="checkMsgModelLabel">修改课程信息</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding-bottom: 0;">
                <table class="table text-center table-striped  shadow ">
                    <tbody id="check-msg-container">
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary courseMsg-yes">确定</button>
            </div>
        </div>
    </div>
</div>
<!--background-color: #4cd137;-->
<script type="text/html" id="courses-show-box-art">
    {{ if data && data.length>0 }}{{each data}}
    <div class="ibox  border shadow courses-show-box">
        <div class="ibox-title border-bottom">
            <h5>{{$value.name}}</h5>
        </div>
        <div class="ibox-content">
            <h1 class="no-margins"><span class="classNumber">{{$value.value}}</span></h1>
        </div>
    </div>
    {{/each}}{{/if}}
</script>
<script type="text/html" id="show-history-box-art">
    {{ if data && data.length>0 }}{{each data}}
    <tr>
        <td>{{$index + 1}}</td>
        <td style="width: 180px">{{$value.COURSE_TIME | formatDateString}}</td>
        <td style="width: 100px">{{$value.COURSE_TYPE_NAME}}</td>
        <td style="width: 100px">{{$value.COURSE_TEACHER_NAME}}</td>
        <td style="width: 100px"><a class="courseDet" href="javascript:;" data-courseid="{{$index}}">点击</a></td>
    </tr>
    {{/each}}{{/if}}
</script>
<script type="text/html" id="show-issue-box-art">
    {{ if data && data.length>0 }}{{each data}}
    <tr>
        <td >{{$index + 1}}</td>
        <td >{{$value.COURSE_TIME | formatDateString}}</td>
        <td >{{$value.COURSE_TYPE_NAME}}</td>
        <td >{{$value.COURSE_TEACHER_NAME}}</td>
        <td >{{$value.COURSE_STATUS | caseStatus }}</td>
        <td ><a class="checkBtn" href="javascript:;" data-courseid="{{$index}}">编辑</a></td>
    </tr>
    {{/each}}{{/if}}
</script>
<script type="text/html" id="course-msg-art">
    {{ if courseDetail}}
    <tr>
        <td class="align-middle">课程ID</td>
        <td class="align-middle"><p></p>{{courseDetail.COURSE_ID}}</td>
    </tr>
    <tr>
        <td class="align-middle">课程名</td>
        <td class="align-middle"><p></p>{{courseDetail.COURSE_NAME}}</td>
    </tr>
    <tr>
        <td class="align-middle">课程类型</td>
        <td class="align-middle"><p type="text">{{courseDetail.COURSE_TYPE_NAME}}</td>
    </tr>
    <tr>
        <td class="align-middle">课程详细内容</td>
        <td class="align-middle"><p>{{courseDetail.COURSE_DETAIL}}</td>
    </tr>
    <tr>
        <td class="align-middle">课程老师</td>
        <td class="align-middle"><p>{{courseDetail.COURSE_TEACHER_NAME}}</p></td>
    </tr>
    <tr>
        <td class="align-middle">课程时间</td>
        <td class="align-middle"><p>{{courseDetail.COURSE_TIME | formatDateString}}</p></td>
    </tr>
    <tr>
        <td class="align-middle">课程状态</td>
        <td class="align-middle"><p>{{courseDetail.COURSE_STATUS}}</p></td>
    </tr>
    {{/if}}
</script>
<script type="text/html" id="check-msg-art">
    {{ if courseDetail}}
    <tr>
        <td class="align-middle">课程名</td>
        <td class="align-middle"><input class="form-control" id="course_name" type="text"
                                        value="{{courseDetail.COURSE_NAME}}"/></td>
    </tr>
    <tr>
        <td class="align-middle">课程类型</td>
        <td class="align-middle"><input class="form-control" type="text" id="course_typeName"
                                        value="{{courseDetail.COURSE_TYPE_NAME}}" readonly="readonly"></td>
    </tr>
    <tr>
        <td class="align-middle">课程详细内容</td>
        <td class="align-middle"><input class="form-control" type="text" id="course_detail"
                                        value="{{courseDetail.COURSE_DETAIL}}"></td>
    </tr>
    <tr>
        <td class="align-middle">课程老师</td>
        <td class="align-middle"><input class="form-control" type="text" id="course_teacherName"
                                        value="{{courseDetail.COURSE_TEACHER_NAME}}" readonly="readonly"></td>
    </tr>
    <tr>
        <td class="align-middle">课程时间</td>
        <td class="align-middle"><input class="form-control" type="text" id="course_time"
                                        value="{{courseDetail.COURSE_TIME | formatDateString}}"></td>
    </tr>
    <tr>
        <td colspan='2' style='text-align: center'>
            <p><a href="javascript:;" class="text-decoration-none del-course"
                  data-courseid="{{courseDetail.COURSE_ID}}">取消课程</a>
            </p>
        </td>
    </tr>
    {{/if}}
</script>
<script type="text/html" id="show-user-list-art">
    {{ if data && data.length>0 }}{{each data}}
    <tr>
        <td >{{$index + 1}}</td>
        <td >{{$value.user_ID}}</td>
        <td >{{$value.user_NBR}}</td>
        <td >{{$value.user_NAME}}</td>
        <td >{{$value.user_SEX}}</td>
        <td >{{$value.user_PHONE}}</td>
        <td >{{$value.update_TIME | formatDateString}}</td>
        <td ><a class="compile" href="javascript:;" data-uid="{{$value.user_NBR}}">编辑</a></td>
    </tr>
    {{/each}}{{/if}}
</script>

<script src="/js/jquery-3.1.1.min.js"></script>
<script src="/js/bootstrap/bootstrap-v4.3.1.min.js"></script>
<script src="/js/echarts/echarts.min.js"></script>
<script src="/js/bootstrap/datepicker/bootstrap-datetimepicker.min.js"></script>
<script src="/js/bootstrap/datepicker/locales/bootstrap-datetimepicker.zh-CN.js"></script>
<script src="/js/app.js"></script>
<script type="text/javascript">
    template.helper('formatDateString', function (value) {
        return new Date(value).format('yyyy-MM-dd hh:mm');
    });
    template.helper('caseStatus', function (value) {
        switch (value) {
            case 0:
                return "可预约";
            case 1:
                return "过期";
            case 2:
                return "已取消";
            default:
                return "异常";
        }
    });
    var admin = (function () {
        var bindEvents = function () {
            App.loader();
            admin.getAdminMsg()
            .then(function(){App.removeLoader();return this;});
        };
        return {
            data: {},
            el: function (expr) {
                return $(expr ? expr : 'body');
            },
            init: function () {
                bindEvents();
                return;
            },
            show: function () {
                admin.el().show();
                return this;
            },
            hide: function () {
                admin.el().hide();
                return this;
            },
            varMatChart: function (typeData,courseData) {
                // 基于准备好的dom，初始化echarts实例
                var myChart = echarts.init(document.getElementById('show-data-content'));
                var myChartoption = {
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: typeData
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    toolbox: {
                        feature: {
                            saveAsImage: {}
                        }
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]
                    },
                    yAxis: {
                        type: 'value'
                    },
                    series:courseData
                };
                // 使用刚指定的配置项和数据显示图表。
                myChart.setOption(myChartoption);
            },
            varMyPieChart: function (data) {
                var myPieChart = echarts.init(document.getElementById('show-pie-chart'));
                option = {
                    series: [{
                        name: '课程比例',
                        type: 'pie',
                        radius: '55%',
                        // roseType: 'angle',
                        data: data
                    }]
                };
                myPieChart.setOption(option);
            },
            uploadFile: function () {
                var $file = document.getElementById("#userFile");
                var fileVal = admin.el("#userFile").val();//用户文件内容(文件)
                // 判断文件是否为空
                if (fileVal == "") {
                    App.alert("请选择上传的目标文件! ", "", 3, function () {
                        return;
                    });
                    return;
                }
                //判断文件类型,我这里根据业务需求判断的是Excel文件
                var fileName1 = fileVal.substring(fileVal.lastIndexOf(".") + 1).toLowerCase();
                if (fileName1 != "xls" && fileName1 != "xlsx") {
                    App.alert("请选择Execl文件!", "", 3, function () {
                        return;
                    });
                    return;
                }
                //判断文件大小
                var size1 = $("#userFile")[0].files[0].size;
                if (size1 > 104857600) {
                    alert("上传文件不能大于100M!");
                    return;
                }
                var formData = new FormData();//这里需要实例化一个FormData来进行文件上传
                formData.append("file", $("#userFile")[0].files[0]);
                App.loader();
                $.ajax({
                    type: "post",
                    url: "/dtr/user-file/upload",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (data) {
                        if (!App.checker(data)) {
                            return;
                        } else {
                            App.removeLoader();
                            App.alert("提交成功");
                            return;
                        }
                    }
                });
            },
            selectBoxShow: function () {
                admin.el("#input-select-box").show();
                admin.el("#back-select-box").hide();
                admin.el("#upload-box").hide();
                admin.el("#msg-input-box").hide();
            },
            selectBoxHide: function () {
                admin.el("#input-select-box").hide();
                admin.el("#back-select-box").show();
            },
            uploadBoxShow: function () {
                admin.el("#upload-box").show();
                admin.el("#msg-input-box").hide();
            },
            magInputBoxShow: function () {
                admin.el("#upload-box").hide();
                admin.el("#msg-input-box").show();
            },
            panelClick:function () {
                admin.el("#back-select-box").off("click").on("click", function () {
                    admin.selectBoxShow();
                });
                admin.el("#upload-btn").off("click").on("click", function () {
                    admin.uploadFile();
                });
                admin.el("#input-once").off("click").on("click", function () {
                    admin.selectBoxHide();
                    admin.magInputBoxShow();
                });
                admin.el("#input-batch").off("click").on("click", function () {
                    admin.selectBoxHide();
                    admin.uploadBoxShow();
                });
                admin.el("#msg-input-btn").off("click").on("click", function () {
                    var userName = admin.el('#userName').val();
                    var userType = admin.el('#userType').val();
                    var userNbr = admin.el('#userNbr').val();
                    var userSex = admin.el('#userSex').val();
                    var userPhone = admin.el('#userPhone').val();
                    $.loadJSON('/dtr/admin/addUser', {
                        userName: userName,
                        userType: userType,
                        userNbr: userNbr,
                        userSex: userSex,
                        userPhone: userPhone
                    }).done(function (data) {
                        if (!App.checker(data)) {
                            return;
                        } else {
                            App.alert("提交成功", '', 1, function () {
                                admin.inputClear();
                            });
                            return;
                        }
                    });
                });
                admin.el("#admin-loginOut").off("click").on("click", function () {
                    var adminID = admin.el(".adminName").data("adminID");
                    $.loadJSON('/dtr/admin/adminOut', {
                        adminID:adminID
                    }).done(function (data) {
                        if (!App.checker(data)) {
                            return;
                        } else {
                            App.alert("退出成功", '', 1, function () {App.goAdminLoginBySelf()});
                            return;
                        }
                    });
                });
                admin.el(".courseDet").off("click").on("click", function () {
                    var courseid = $(this).data("courseid");
                    var dataList = admin.el("#show-history-box-container").data("courseList");
                    var dataDet = dataList[courseid];
                    admin.paddingCourseShowModel(dataDet).then(function(){admin.el("#courseMsgModel").modal("show")});
                });
                admin.el(".checkBtn").off("click").on("click", function () {
                    var courseid = $(this).data("courseid");
                    var dataList = admin.el("#check-msg-container").data("courseList");
                    var dataDet = dataList[courseid];
                    admin.paddingCourseCheckShowModel(dataDet).then(function(){admin.el("#checkMsgModel").modal("show")});
                    admin.panelClick();
                });
                admin.el('.courseMsg-yes').off('click').on('click', function () {
                    var courseID = admin.el('.del-course').data("courseid");
                    var course_name = admin.el("#course_name").val();
                    var course_detail = admin.el("#course_detail").val();
                    var course_time = admin.el("#course_time").val() + ':00';
                    $.loadJSON('/dtr/issue/updateCourse', {
                        courseID: courseID,
                        courseName: course_name,
                        courseDetail: course_detail,
                        courseTime: course_time
                    }).done(function (data) {
                        if (!App.checker(data)) {
                            return;
                        } else {
                            App.alert("修改成功", "", 1, function () {
                                admin.el("#checkMsgModel").modal("hide");
                                admin.getCourseList()
                            });
                        }
                    });
                });
                admin.el('.del-course').off('click').on('click', function () {
                    var courseID = $(this).data('courseid');
                    App.selectAlert("操作提示", "确定取消吗？", 3, function () {
                        $.loadJSON('/dtr/issue/cancelCourse', {
                            courseID: courseID
                        }).done(function (data) {
                            if (!App.checker(data)) {
                                return;
                            } else {
                                App.alert("取消成功", "", 1, function () {
                                    admin.getCourseList()
                                });
                            }
                        });
                    });
                });
            },
            getMsgPast:function(){
                $.loadJSON('/dtr/admin/getHistory').done(function (data) {
                    if (!App.checker(data)) {
                        return;
                    } else {
                        var dataPie = data.pastWeek;
                        var typeData = data.typeList;
                        var courseData = data.pastMonth.courseList;
                        var courseList = data.pastMonthCourseList;
                        admin.el("#show-history-box-container").data("courseList",courseList);
                        admin.paddingCourseShowBox(courseList);
                        admin.varMyPieChart(dataPie);
                        admin.varMatChart(typeData,courseData);
                        admin.paddingShowBox(dataPie)
                            .then(function () {admin.panelClick();return this})
                            .then(function () {App.randomBackgroundColor("courses-show-box");return this});
                        return;
                    }
                });
            },
            getCourseList:function(){
                $.loadJSON('/dtr/admin/getCouList').done(function (data) {
                    if (!App.checker(data)) {
                        return;
                    } else {
                        var dataList = data.oneMonth;
                        admin.el("#check-msg-container").data("courseList",dataList);
                        admin.paddingIssueBox(dataList).then(function(){admin.panelClick();return this;});
                        return;
                    }
                });
            },
            getUserList:function(){
                $.loadJSON('/dtr/admin/getAllUser').done(function (data) {
                    if (!App.checker(data)) {
                        return;
                    } else {
                        var stuList = data.stuList;
                        var teaList = data.teaList;
                        console.log(teaList);
                        admin.paddingStuList(stuList);
                        admin.paddingTeaList(teaList);
                        // admin.el("#check-msg-container").data("courseList",stuList);
                        // admin.paddingIssueBox(dataList).then(function(){admin.panelClick();return this;});
                        return;
                    }
                });
            },
            paddingShowBox:function (data) {
                return $.Deferred(function (defer) {
                    admin.el("#courses-show-box-container").html(template('courses-show-box-art', {data: data}));
                    defer.resolve();
                }).promise();
            },
            paddingIssueBox:function (data) {
                return $.Deferred(function (defer) {
                    admin.el("#show-issue-box-container").html(template('show-issue-box-art', {data: data}));
                    defer.resolve();
                }).promise();
            },
            paddingCourseShowBox:function (data) {
                return $.Deferred(function (defer) {
                    admin.el("#show-history-box-container").html(template('show-history-box-art', {data: data}));
                    defer.resolve();
                }).promise();
            },
            paddingCourseShowModel:function (data) {
                return $.Deferred(function (defer) {
                    admin.el("#course-msg-container").html(template('course-msg-art', {courseDetail: data}));
                    defer.resolve();
                }).promise();
            },
            paddingCourseCheckShowModel:function (data) {
                return $.Deferred(function (defer) {
                    admin.el("#check-msg-container").html(template('check-msg-art', {courseDetail: data}));
                    App.setInputBoxForTime('#course_time');
                    defer.resolve();
                }).promise();
            },
            paddingStuList:function(data){
                return $.Deferred(function (defer) {
                    admin.el("#show-stu-list-container").html(template('show-user-list-art', {data: data}));
                    defer.resolve();
                }).promise();
            },
            paddingTeaList:function(data){
                return $.Deferred(function (defer) {
                    admin.el("#show-tea-list-container").html(template('show-user-list-art', {data: data}));
                    defer.resolve();
                }).promise();
            },
            getAdminMsg:function () {
                return $.Deferred(function (defer) {
                    $.loadJSON('/dtr/admin/getAdmin').done(function (data) {
                        if (!App.checker(data)) {
                            App.alert("管理员未登录！","",2,function(){
                               App.goAdminLoginBySelf();
                            });
                        } else {
                            var adminName = data.admin.name;
                            var adminID = data.admin.id;
                            admin.el(".adminName").html(adminName);
                            admin.el(".adminName").data("adminID",adminID);
                            admin.getMsgPast();
                            admin.getCourseList();
                            admin.getUserList();
                            admin.panelClick();
                        }
                    });
                    defer.resolve();
                }).promise();
            }
        }
    })();
    $(function () {
        admin.init();
    });
</script>
</body>

</html>